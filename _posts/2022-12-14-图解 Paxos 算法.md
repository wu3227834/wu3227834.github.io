---
layout: mypost
title: 图解 Paxos 算法
categories: [分布式架构,Paxos,极客时间学习笔记]
---
# <center>图解 Paxos 算法</center>
&emsp;&emsp;Paxos 算法是一个分布式共识算法，由 Leslie Lamport 在 1989 年提出，该算法理解起来有一定的难度，本文尝试图形化解析 Paxos 算法。

Lamport 提出的 Paxos 算法包括两个部分：
<ul>
    <li>Basic Paxos 算法：多节点如何就某个值（提案Value）达成共识</li>
    <li>Multi-Paxos 思想：执行多个 Basic Paxos 实例，就一系列的值达成共识</li>
</ul>

## Basic Paxos
### 思考题
&emsp;&emsp;假设现在有一个三节点的分布式集群，提供只读 KV 存储服务。只读 KV 服务，既创建只读变量（key）的时候，必须要对它进行赋值（value），而且这个值后续没办法修改。也就是说，只读变量在创建后就不能被修改了，所以所有节点必须要先对只读变量的值达成共识，然后再去创建这个只读变量。

&emsp;&emsp;那么，当有多个客户端（比如客户端 1、2）访问这个系统，试图创建同一个只读变量（比如 X），客户端 1 试图创建值为 5 的 X，客户端 2 试图创建值为 7 的 X，这样要如何达成共识，实现各节点上 X 值的一致呢？

![如何在多个节点间确定某变量的值](pho1.png "图1")

在解决这个问题之前，先了解一下 Basic Paxos 的几个概念。

## Paxos 涉及的概念
&emsp;&emsp;在 Basic Paxos 中，有提议者（Proposer）、接受者（Acceptor）、学习者（Learner）三种角色：
<ul>
    <li>提议者：提议一个值，用于投票表决。为了方便演示，你可以把图 1 中的客户端 1 和 2 看作是提议者。但在绝大多数场景中，集群中收到客户端请求的节点，才是提议者（图 1 这个架构，是为了方便演示算法原理）。</li>
    <li>接受者：每个提议的值进行投票，并存储接受的值，比如 A、B、C 三个节点。</li>
    <li>学习者：被告知投票的结果，接受达成共识的值，存储保存，不参与投票的过程。</li>
</ul>

需要指出的是，**一个节点，既可以是提议者，也可以是接受者**。
他们之间的关系如下：

![角色之间的关系](pho1.png "图2")



-- 未完 --










&emsp;&emsp;本文参考了韩健极客时间的课程<a href="https://time.geekbang.org/column/intro/279">《分布式协议与算法》。</a>


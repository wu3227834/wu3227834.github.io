<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:description" content="这里是小布丁的私有小屋"><meta property="og:type" content="website"><meta name="keywords" content="Git、rebase、reset、filter-branch、版本控制,"><meta name="description" content="本教程系统讲解 Git 从克隆、分支管理到 rebase、filter-branch、reset 等高级操作，涵盖代码拉取、提交合并、历史清理与回退等常见场景。"><link rel="shortcut icon" href="/img/favicon.ico"><title>git 教程</title><link rel="stylesheet" href="/css/aircloud.css"><link rel="stylesheet" href="/css/gitment.css"><link rel="stylesheet" href="/css/prism.css"><link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css"><script></script><script defer src="https://cloud.umami.is/script.js" data-website-id="bad0a741-25cb-4dd6-bbcf-f5710aeb243c"></script><script type="text/javascript">((e,t,s,n,a,c)=>{e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},(a=t.createElement(n)).async=1,a.src="https://www.clarity.ms/tag/sgs6id3d37",(c=t.getElementsByTagName(n)[0]).parentNode.insertBefore(a,c)})(window,document,"clarity","script")</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Pudding 日常" type="application/atom+xml"></head><body><div class="site-nav-toggle" id="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><div class="index-about"><i>a week is 2% of the year</i></div><div class="index-container"><div class="index-left"><div class="nav" id="nav"><div class="avatar-name"><div class="avatar"><img src="/img/avatar.png"></div><div class="name"><i>Pudding</i></div></div><div class="contents" id="nav-content"><ul><li><a href="/"><i class="iconfont icon-shouye1"></i> <span>主页</span></a></li><li><a href="/tags"><i class="iconfont icon-biaoqian1"></i> <span>标签</span></a></li><li><a href="/archive"><i class="iconfont icon-guidang2"></i> <span>存档</span></a></li><li><a href="/about/"><i class="iconfont icon-guanyu2"></i> <span>关于</span></a></li><li><a id="search"><i class="iconfont icon-sousuo1"></i> <span>搜索</span></a></li></ul></div><div id="toc" class="toc-article"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%EF%BC%88%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%89%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%A0%81"><span class="toc-text">从远程仓库（服务器）获取代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%B2%A1%E6%9C%89%E4%BB%93%E5%BA%93%EF%BC%8C%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%93"><span class="toc-text">本地没有仓库，新建仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8E%BB%E9%BB%98%E8%AE%A4%E5%88%86%E6%94%AF%E4%BB%A3%E7%A0%81"><span class="toc-text">拉去默认分支代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-text">自定义本地仓库文件名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E7%89%B9%E5%AE%9A%E5%88%86%E6%94%AF%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">拉取特定分支的代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E6%8C%87%E5%AE%9A%E6%A0%87%E7%AD%BE%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">拉取指定标签的代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%B7%B2%E7%BB%8F%E5%AD%98%E5%9C%A8%E4%BA%86%E4%BB%93%E5%BA%93"><span class="toc-text">本地已经存在了仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E6%96%B0%E5%88%86%E6%94%AF%E4%BB%A3%E7%A0%81"><span class="toc-text">拉取新分支代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%EF%BC%8C%E6%8B%89%E5%8F%96%E6%8C%87%E5%AE%9A%E4%BB%93%E5%BA%93"><span class="toc-text">有多个远程仓库，拉取指定仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E5%88%86%E6%94%AF%E6%8B%89%E5%8F%96%E5%88%AB%E7%9A%84%E5%88%86%E6%94%AF%E4%BB%A3%E7%A0%81"><span class="toc-text">当前分支拉取别的分支代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%95%99%E7%A8%8B"><span class="toc-text">高级教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-git-rebase-%E5%90%88%E5%B9%B6%E5%A4%9A%E6%AC%A1-commit"><span class="toc-text">使用 git rebase 合并多次 commit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%8A%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%BB%8E%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2%E4%B8%AD%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4"><span class="toc-text">把一个文件从提交历史中彻底删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E5%90%8E%E6%82%94%E5%88%A0%E9%99%A4%E4%BA%86%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%A6%82%E4%B8%8B%E5%91%BD%E4%BB%A4%E6%81%A2%E5%A4%8D"><span class="toc-text">如果后悔删除了，可以使用如下命令恢复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%8A%E5%88%A0%E9%99%A4%E5%90%8E%E7%9A%84%E9%A1%B9%E7%9B%AE%E6%8F%90%E4%BA%A4%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">把删除后的项目提交到服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%9B%9E%E9%80%80%E6%93%8D%E4%BD%9C"><span class="toc-text">代码回退操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AA%E7%A7%BB%E5%8A%A8-HEAD%EF%BC%88%E7%9B%B8%E5%BD%93%E4%BA%8E%E5%8F%96%E6%B6%88%E4%B8%8A%E6%AC%A1%E6%8F%90%E4%BA%A4%EF%BC%89"><span class="toc-text">只移动 HEAD（相当于取消上次提交）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8-HEAD%EF%BC%8C%E6%9B%B4%E6%96%B0-index"><span class="toc-text">移动 HEAD，更新 index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8-HEAD%EF%BC%8C%E6%9B%B4%E6%96%B0-index%EF%BC%8C%E6%9B%B4%E6%96%B0%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95"><span class="toc-text">移动 HEAD，更新 index，更新工作目录</span></a></li></ol></li></ol></li></ol></div></div><div class="search-field" id="search-field"><div class="search-bg" id="search-bg"></div><div class="search-container"><div class="search-input"><span id="esc-search"><i class="icon-fanhui iconfont"></i></span> <input id="search-input"> <span id="begin-search">搜索</span></div><div class="search-result-container" id="search-result-container"></div></div></div><div class="index-about-mobile"><i>a week is 2% of the year</i></div></div><div class="index-middle"><div class="post-container"><div class="post-title">git 教程</div><div class="post-meta"><span class="attr">发布于：<span>2025-11-17</span></span> <span class="attr">标签：/ <a class="tag" href="/tags/#Git" title="Git">Git</a> <span>/</span> </span><span class="attr">访问：<span id="busuanzi_value_page_pv"></span></span></div><div class="post-content no-indent"><h2 id="从远程仓库（服务器）获取代码"><a href="#从远程仓库（服务器）获取代码" class="headerlink" title="从远程仓库（服务器）获取代码"></a>从远程仓库（服务器）获取代码</h2><h3 id="本地没有仓库，新建仓库"><a href="#本地没有仓库，新建仓库" class="headerlink" title="本地没有仓库，新建仓库"></a>本地没有仓库，新建仓库</h3><h4 id="拉去默认分支代码"><a href="#拉去默认分支代码" class="headerlink" title="拉去默认分支代码"></a>拉去默认分支代码</h4><p>如果本地没有代码，远程仓库有代码，则需要从远程仓库克隆代码。克隆仓库的命令格式是 <code>git clone [url]</code>。比如，要克隆 Git 的可链接库 libgit2，可以用下面的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/libgit2/libgit2</span></span><br></pre></td></tr></table></figure><p>这会在当前目录下创建一个名为 “libgit2” 的目录，并在这个目录下初始化一个 .git 文件夹，从远程仓库拉取下所有数据放入 .git 文件夹，然后从中读取最新版本的文件的拷贝。<br>如果你进入到这个新建的 libgit2 目录，你会发现所有的项目文件已经在里面了，准备就绪等待后续的开发和使用。</p><h4 id="自定义本地仓库文件名"><a href="#自定义本地仓库文件名" class="headerlink" title="自定义本地仓库文件名"></a>自定义本地仓库文件名</h4><p>如果你想在克隆远程仓库的时候，自定义本地仓库的名字，你可以使用如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/libgit2/libgit2 mylibgit</span></span><br></pre></td></tr></table></figure><p>这将执行与上一个命令相同的操作，不过在本地创建的仓库名字变为 mylibgit。</p><h4 id="拉取特定分支的代码"><a href="#拉取特定分支的代码" class="headerlink" title="拉取特定分支的代码"></a>拉取特定分支的代码</h4><p>如果不想克隆默认分支的代码，可以克隆指定分支的代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> -b pages-aliyun https://gitee.com/dragon-li/front-end-doc</span></span><br><span class="line"></span><br><span class="line">Cloning into &#x27;front-end-doc&#x27;...</span><br><span class="line">remote: Enumerating objects: 941, done.</span><br><span class="line">remote: Counting objects: 100% (941/941), done.</span><br><span class="line">remote: Compressing objects: 100% (463/463), done.</span><br><span class="line">remote: Total 2633 (delta 615), reused 697 (delta 470), pack-reused 1692</span><br><span class="line">Receiving objects: 100% (2633/2633), 21.79 MiB | 2.26 MiB/s, done.</span><br><span class="line">Resolving deltas: 100% (1610/1610), done.</span><br></pre></td></tr></table></figure><h4 id="拉取指定标签的代码"><a href="#拉取指定标签的代码" class="headerlink" title="拉取指定标签的代码"></a>拉取指定标签的代码</h4><p>git 允许直接克隆特定分支的代码，不过克隆好后，项目里没有分支，需要自己创建一个分支：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> -b V2.2 http://192.168.102.9/jas-paas/cloudlink-front-framework.git</span></span><br><span class="line"></span><br><span class="line">Cloning into &#x27;cloudlink-front-framework&#x27;...</span><br><span class="line">remote: Counting objects: 14436, done.</span><br><span class="line">remote: Compressing objects: 100% (3072/3072), done.</span><br><span class="line">remote: Total 14436 (delta 11224), reused 14226 (delta 11075)</span><br><span class="line">Receiving objects: 100% (14436/14436), 17.93 MiB | 4.70 MiB/s, done.</span><br><span class="line">Resolving deltas: 100% (11224/11224), done.</span><br><span class="line">Note: checking out &#x27;eeea534cdae1f82c48c7b0de8f9993b54ffa065d&#x27;.</span><br><span class="line"></span><br><span class="line">You are in &#x27;detached HEAD&#x27; state. You can look around, make experimental</span><br><span class="line">changes and commit them, and you can discard any commits you make in this</span><br><span class="line">state without impacting any branches by performing another checkout.</span><br><span class="line"></span><br><span class="line">If you want to create a new branch to retain commits you create, you may</span><br><span class="line">do so (now or later) by using -b with the checkout command again. Example:</span><br><span class="line"></span><br><span class="line">  git checkout -b &lt;new-branch-name&gt;</span><br></pre></td></tr></table></figure><p>从信息中就可以看见，克隆特定标签的项目后，是没有分支的，需要进入项目目录后，使用命令创建一个分支：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b V2.2</span><br></pre></td></tr></table></figure><h3 id="本地已经存在了仓库"><a href="#本地已经存在了仓库" class="headerlink" title="本地已经存在了仓库"></a>本地已经存在了仓库</h3><h4 id="拉取新分支代码"><a href="#拉取新分支代码" class="headerlink" title="拉取新分支代码"></a>拉取新分支代码</h4><p>例如，本地就一个master分支，远程有2个分支(master,develop)，把远程的develop拉取到本地：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">本地的分支是干净的，也就是没有修改的文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取远程所有分支名字</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git fetch</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示远程所有分支名字</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -a</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">提取远程新分支到本地</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -b develop origin/develop</span></span><br></pre></td></tr></table></figure><h4 id="有多个远程仓库，拉取指定仓库"><a href="#有多个远程仓库，拉取指定仓库" class="headerlink" title="有多个远程仓库，拉取指定仓库"></a>有多个远程仓库，拉取指定仓库</h4><p>比如 远程仓库有2个： origin、github，默认仓库是 origin，如果想要来去 github 仓库的代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull github master</span><br></pre></td></tr></table></figure><h4 id="当前分支拉取别的分支代码"><a href="#当前分支拉取别的分支代码" class="headerlink" title="当前分支拉取别的分支代码"></a>当前分支拉取别的分支代码</h4><p>比如，当前是 test 分支，需要拉取 develop 分支代码，运行如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin develop</span><br></pre></td></tr></table></figure><h2 id="高级教程"><a href="#高级教程" class="headerlink" title="高级教程"></a>高级教程</h2><h3 id="使用-git-rebase-合并多次-commit"><a href="#使用-git-rebase-合并多次-commit" class="headerlink" title="使用 git rebase 合并多次 commit"></a>使用 git rebase 合并多次 commit</h3><p>使用 git log 查看一下历史：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span></span> </span><br><span class="line"></span><br><span class="line">commit 3fa2e1a951ff823fbec625a96049e27ef35a85b8 (HEAD -&gt; dev, origin/dev)</span><br><span class="line">Author: yulilong &lt;yulilong222q@outlook.com&gt;</span><br><span class="line">Date:   Thu Nov 2 11:29:00 2017 +0800</span><br><span class="line"></span><br><span class="line">    合并提交测试3号,测试修改最后一次提交。在测试一下。</span><br><span class="line"></span><br><span class="line">commit f526876def0b80676bfcf52937f78052e2d63955</span><br><span class="line">Author: yulilong &lt;yulilong222q@outlook.com&gt;</span><br><span class="line">Date:   Thu Nov 2 11:27:20 2017 +0800</span><br><span class="line"></span><br><span class="line">    合并提交测试2号</span><br><span class="line"></span><br><span class="line">commit 4d2b6ce4d5154c0b739e552e679bb7f4ce05fb2c</span><br><span class="line">Author: yulilong &lt;yulilong222q@outlook.com&gt;</span><br><span class="line">Date:   Thu Nov 2 11:25:59 2017 +0800</span><br><span class="line"></span><br><span class="line">    合并提交测试一号</span><br><span class="line"></span><br><span class="line">commit 9e791f38f4d5f472a371a8c147f37670185582f8</span><br><span class="line">Author: yulilong &lt;yulilong222q@outlook.com&gt;</span><br><span class="line">Date:   Mon Oct 30 10:22:02 2017 +0800</span><br><span class="line"></span><br><span class="line">    这是dev分支上的合并提交测试</span><br><span class="line"></span><br><span class="line">commit 4baf2a319c0de8f46630ba85db11cc4aebd1d2cd</span><br><span class="line">Author: yulilong &lt;yulilong222q@outlook.com&gt;</span><br><span class="line">Date:   Fri Sep 29 10:20:08 2017 +0800</span><br><span class="line"></span><br><span class="line">    这是测试-a -m命令提交记录</span><br></pre></td></tr></table></figure><p>如果想要合并最后三次的提交，可使用 <code>git rebase -i HEAD~3</code> 或 <code>git rebase -i 9e791f38f4d</code> 命令来压缩。该命令执行后，会弹出一个编辑窗口，3 次提交的 commit 倒叙排列，最上面的是最早的提交，最下面的是最近一次提交。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> 1 pick 4d2b6ce 合并提交测试一号</span><br><span class="line"> 2 pick f526876 合并提交测试2号</span><br><span class="line"> 3 pick 3fa2e1a 合并提交测试3号,测试修改最后一次提交。在测试一下。</span><br><span class="line"> 4 </span><br><span class="line"> 5 # Rebase 9e791f4..3fa2e1a onto 9e791f3 (3 commands)</span><br><span class="line"> 6 #</span><br><span class="line"> 7 # Commands:</span><br><span class="line"> 8 # p, pick = use commit</span><br><span class="line"> 9 # r, reword = use commit, but edit the commit message</span><br><span class="line">10 # e, edit = use commit, but stop for amending</span><br><span class="line">11 # s, squash = use commit, but meld into previous commit</span><br><span class="line">12 # f, fixup = like &quot;squash&quot;, but discard this commit&#x27;s log message</span><br><span class="line">13 # x, exec = run command (the rest of the line) using shell</span><br><span class="line">14 # d, drop = remove commit</span><br><span class="line">15 #</span><br><span class="line">16 # These lines can be re-ordered; they are executed from top to bottom.</span><br><span class="line">17 #</span><br><span class="line">18 # If you remove a line here THAT COMMIT WILL BE LOST.</span><br><span class="line">19 #</span><br><span class="line">20 # However, if you remove everything, the rebase will be aborted.</span><br><span class="line">21 #</span><br><span class="line">22 # Note that empty commits are commented out</span><br></pre></td></tr></table></figure><p>修改第二行、第三行的第一个单词 pick 为 squash（这些命令什么意思下面的注释有说明）<br>然后保存退出，git 会压缩提交历史<br>如果有冲突，需要修改，修改的时候要注意，保留最新的历史，不然我们的修改就丢弃了<br>修改以后要记得敲下面的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add .</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">git rebase --<span class="built_in">continue</span></span></span><br></pre></td></tr></table></figure><p>如果你想要放弃这次压缩的话，执行以下的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase --abort</span><br></pre></td></tr></table></figure><p>如果没有冲突，或者冲突已经解决，则会出现如下的编辑窗口：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"> 1 # This is a combination of 3 commits.</span><br><span class="line"> 2 # This is the 1st commit message:</span><br><span class="line"> 3 </span><br><span class="line"> 4 合并提交测试一号</span><br><span class="line"> 5 </span><br><span class="line"> 6 # This is the commit message #2:</span><br><span class="line"> 7 </span><br><span class="line"> 8 合并提交测试2号</span><br><span class="line"> 9 </span><br><span class="line">10 # This is the commit message #3:</span><br><span class="line">11 </span><br><span class="line">12 合并提交测试3号,测试修改最后一次提交。在测试一下。</span><br><span class="line">13      </span><br><span class="line">14 # Please enter the commit message for your changes. Lines starting</span><br><span class="line">15 # with &#x27;#&#x27; will be ignored, and an empty message aborts the commit.</span><br><span class="line">16 #   </span><br><span class="line">17 # Date:      Thu Nov 2 11:25:59 2017 +0800</span><br><span class="line">18 #        </span><br><span class="line">19 # interactive rebase in progress; onto 9e791f3</span><br><span class="line">20 # Last commands done (3 commands done):</span><br><span class="line">21 #    squash f526876 合并提交测试2号</span><br><span class="line">22 #    squash 3fa2e1a 合并提交测试3号,测试修改最后一次提交。在测试一下。</span><br><span class="line">23 # No commands remaining.</span><br><span class="line">24 # You are currently rebasing branch &#x27;dev&#x27; on &#x27;9e791f3&#x27;.</span><br><span class="line">25 #</span><br><span class="line">26 # Changes to be committed:</span><br><span class="line">27 #   modified:   1.txt</span><br><span class="line">28 #   new file:   5.txt</span><br><span class="line">29 #   new file:   6.txt</span><br></pre></td></tr></table></figure><p>编辑好合并的提交信息后保存，可看见如下输出信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[detached HEAD 83d65c7] 三次合并提交的测试，成功了。</span><br><span class="line"> Date: Thu Nov 2 11:25:59 2017 +0800</span><br><span class="line"> 3 files changed, 7 insertions(+)</span><br><span class="line"> create mode 100644 5.txt</span><br><span class="line"> create mode 100644 6.txt</span><br><span class="line">Successfully rebased and updated refs/heads/dev.</span><br></pre></td></tr></table></figure><p>最后把合并的记录强推到服务器中去：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git push -f</span><br><span class="line">Counting objects: 5, done.</span><br><span class="line">Delta compression using up to 8 threads.</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (5/5), 596 bytes | 596.00 KiB/s, done.</span><br><span class="line">Total 5 (delta 1), reused 0 (delta 0)</span><br><span class="line">To http://192.168.102.9/yulilong/test.git</span><br><span class="line"> + 3fa2e1a...83d65c7 dev -&gt; dev (forced update)</span><br></pre></td></tr></table></figure><p>服务器合并提交前：</p><p><img src="/img/2025-11-17-git%E6%95%99%E7%A8%8B/image.jpg" alt="合并前"></p><p>服务器合并后：</p><p><img src="/img/2025-11-17-git%E6%95%99%E7%A8%8B/image2.jpg" alt="合并后"></p><h3 id="把一个文件从提交历史中彻底删除"><a href="#把一个文件从提交历史中彻底删除" class="headerlink" title="把一个文件从提交历史中彻底删除"></a>把一个文件从提交历史中彻底删除</h3><p>有些人不经思考使用 <code>git add .</code>，意外地提交了一个巨大的二级制文件，你想将它从所有地方删除。也许你不小心提交了一个包含密码的文件，而你想让你的项目开源。filter-branch 大概会是你用来清理整个历史的工具。</p><p>如果想要从整个历史中删除 1.txt 文件，你可以在 <code>filter-branch</code> 上使用 <code>--tree-filter</code> 选项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git filter-branch -f --tree-filter &#x27;rm -f 1.txt&#x27; HEAD </span><br><span class="line">Rewrite 83d65c7b098e0ec1f14d9a332187632b49d2ad9f (5/5) (0 seconds passed, remaining 0 predicted)    </span><br><span class="line">Ref &#x27;refs/heads/dev&#x27; was rewritten</span><br></pre></td></tr></table></figure><p>如果执行命令的时候提示如下错误，删除 <code>.git/refs/original/</code> 目录，或使用 <code>-f</code> 命令强制覆盖：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git filter-branch -f --tree-filter <span class="string">&#x27;rm -f 1.txt&#x27;</span> HEAD</span> </span><br><span class="line">Cannot create a new backup.</span><br><span class="line">A previous backup already exists in refs/original/</span><br><span class="line">Force overwriting the backup with -f   </span><br><span class="line"></span><br><span class="line">git filter-branch -f --tree-filter &#x27;rm -f 1.txt&#x27; HEAD </span><br><span class="line">Rewrite 83d65c7b098e0ec1f14d9a332187632b49d2ad9f (5/5) (0 seconds passed, remaining 0 predicted)    </span><br><span class="line">Ref &#x27;refs/heads/dev&#x27; was rewritten</span><br></pre></td></tr></table></figure><h3 id="如果后悔删除了，可以使用如下命令恢复"><a href="#如果后悔删除了，可以使用如下命令恢复" class="headerlink" title="如果后悔删除了，可以使用如下命令恢复"></a>如果后悔删除了，可以使用如下命令恢复</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard refs/original/refs/heads/dev</span></span><br><span class="line">HEAD is now at 83d65c7 三次合并提交的测试，成功了。</span><br></pre></td></tr></table></figure><h3 id="把删除后的项目提交到服务器"><a href="#把删除后的项目提交到服务器" class="headerlink" title="把删除后的项目提交到服务器"></a>把删除后的项目提交到服务器</h3><p>注意：一旦运行此命令，删除的文件不能找回</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin +dev         </span><br><span class="line"></span><br><span class="line">Counting objects: 14, done.</span><br><span class="line">Delta compression using up to 8 threads.</span><br><span class="line">Compressing objects: 100% (9/9), done.</span><br><span class="line">Writing objects: 100% (14/14), 1.40 KiB | 1.40 MiB/s, done.</span><br><span class="line">Total 14 (delta 1), reused 0 (delta 0)</span><br><span class="line">To http://192.168.102.110/user/test.git</span><br><span class="line"> + 83d65c7...4b4da80 dev -&gt; dev (forced update)</span><br></pre></td></tr></table></figure><p>注意，分支名字前面的 + 号一定不能忘记，否则会报如下错误：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">To http://192.168.102.110/user/test.git</span><br><span class="line"> ! [rejected]        dev -&gt; dev (non-fast-forward)</span><br><span class="line">error: failed to push some refs to &#x27;http://192.168.102.110/user/test.git&#x27;</span><br><span class="line">hint: Updates were rejected because the tip of your current branch is behind</span><br><span class="line">hint: its remote counterpart. Integrate the remote changes (e.g.</span><br><span class="line">hint: &#x27;git pull ...&#x27;) before pushing again.</span><br><span class="line">hint: See the &#x27;Note about fast-forwards&#x27; in &#x27;git push --help&#x27; for details.</span><br></pre></td></tr></table></figure><p>推送之前要把服务器的分支保护去掉，否则会报如下错误：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">remote: GitLab: You are not allowed to force push code to a protected branch on this project.</span><br><span class="line">To http://192.168.102.110/user/test.git</span><br><span class="line"> ! [remote rejected] dev -&gt; dev (pre-receive hook declined)</span><br><span class="line">error: failed to push some refs to &#x27;http://192.168.102.110/user/test.git&#x27;</span><br></pre></td></tr></table></figure><h3 id="代码回退操作"><a href="#代码回退操作" class="headerlink" title="代码回退操作"></a>代码回退操作</h3><h4 id="只移动-HEAD（相当于取消上次提交）"><a href="#只移动-HEAD（相当于取消上次提交）" class="headerlink" title="只移动 HEAD（相当于取消上次提交）"></a>只移动 HEAD（相当于取消上次提交）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard HEAD^</span></span><br><span class="line">或者</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --soft 99ad0ec</span></span><br></pre></td></tr></table></figure><p><code>reset</code> 做的第一件事是移动 <code>HEAD</code> 的指向。<code>reset</code> 移动 <code>HEAD</code> 指向的分支。<br><code>reset --soft</code> 本质上是撤销了上一次 <code>git commit</code> 命令。当你在运行 <code>git commit</code> 时，<code>Git</code> 会创建一个新的提交。<br>并移动 <code>HEAD</code> 所指向的分支来使其指向该提交。当你将它 <code>reset</code> 回 <code>HEAD~</code> 时，其实就是把该分支移动回原来的位置，而不会改变索引和工作目录。</p><p>现在你可以更新索引并再次运行 <code>git commit</code> 来完成 <code>git commit --amend</code> 所要做的事情了。</p><h4 id="移动-HEAD，更新-index"><a href="#移动-HEAD，更新-index" class="headerlink" title="移动 HEAD，更新 index"></a>移动 HEAD，更新 index</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset HEAD~</span></span><br><span class="line">或者</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --mixed HEAD~</span></span><br></pre></td></tr></table></figure><p>它依然会撤销一上次提交，但还会取消暂存所有的东西。于是，我们回滚到了所有 <code>git add</code> 和 <code>git commit</code> 的命令执行之前。</p><h4 id="移动-HEAD，更新-index，更新工作目录"><a href="#移动-HEAD，更新-index，更新工作目录" class="headerlink" title="移动 HEAD，更新 index，更新工作目录"></a>移动 HEAD，更新 index，更新工作目录</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD~</span><br></pre></td></tr></table></figure><p>必须注意，<code>--hard</code> 表示是 <code>reset</code> 命令唯一的危险用法，它也是 <code>Git</code> 会真正地销毁数据的仅有的几个操作之一。<br>其他任何形式的 <code>reset</code> 调用都可以轻松撤销，但是 <code>--hard</code> 选项不能，因为它强制覆盖了工作目录中的文件。<br>在这种特殊情况下，我们的 <code>Git</code> 数据库中一个提交内还留有该文件的 <code>v3</code> 版本，我们可以通过 <code>reflog</code> 来找回它。<br>但是若该文件还未提交，<code>Git</code> 仍会覆盖它从而导致无法恢复。</p><p><code>reset</code> 命令会特定的顺序重写这三棵树，在你指定以下选项时停止：</p><ol><li>移动 HEAD 分支的指向（若指定了 –soft，则到此停止）</li><li>使索引看起来像 HEAD（若未指定 –hard，则到此停止）</li><li>使工作目录看起来像索引</li></ol><br><div id="comment-container"></div><div id="disqus_thread"></div><div id="lv-container"></div><div class="giscus"></div></div></div></div></div><footer class="footer"><ul class="list-inline text-center"><li><a target="_blank" href="https://github.com/wu3227834" rel="external nofollow noreferrer"><span class="fa-stack fa-lg"><i class="iconfont icon-github"></i></span></a></li></ul><p><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span>PV </span><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv"></span>UV </span>Created By <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/">Hexo</a> Theme <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p></footer><script type="text/javascript" src="/js/jquery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script><script type="text/javascript" src="/js/clipboard.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body><script>window.hexo_search_path="search.json",window.hexo_root="/",window.isPost=!0</script><script src="/js/index.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async src="/js/prism.js"></script><script src="https://giscus.app/client.js" data-repo="wu3227834/wu3227834.github.io" data-repo-id="R_kgDOIh8vuA" data-category="General" data-category-id="DIC_kwDOIh8vuM4CpDjz" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script><script>document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var e;0<document.querySelectorAll(".index-middle img").length&&((e=document.createElement("link")).rel="stylesheet",e.href="/js/fancybox/jquery.fancybox.min.css",document.head.appendChild(e),(e=document.createElement("script")).src="/js/fancybox/jquery.fancybox.min.js",e.onload=function(){var e=document.createElement("script");e.src="/js/fancybox/wrapImage.js",document.body.appendChild(e)},document.body.appendChild(e))},1e3)})</script></html>